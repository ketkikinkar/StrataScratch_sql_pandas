/*
Find all inspections which are part of an inactive program


City of Los Angeles
Easy
ID 10277
56

Data Scientist
BI Analyst
Data Analyst
Find all inspections which are part of an inactive program.

Table: los_angeles_restaurant_health_inspections
Hints
Expected Output
Hint #1
To find all inspections which are part of an inactive program, we need to use the SELECT statement along with the WHERE clause.

Hint #2
Keep going! Now, let's write the code to select all columns from the table "los_angeles_restaurant_health_inspections" where the program_status is 'INACTIVE'.

SELECT *
FROM los_angeles_restaurant_health_inspections
WHERE program_status = 'INACTIVE';
Hint #3
Well done! The above code will return all inspections that are part of an inactive program.

los_angeles_restaurant_health_inspections
Preview
serial_number	activity_date	facility_name	score	grade	service_code	service_description	employee_id	facility_address	facility_city	facility_id	facility_state	facility_zip	owner_id	owner_name	pe_description	program_element_pe	program_name	program_status	record_id
DAQHRSETQ	2017-06-08	MARGARITAS CAFE	93	A	1	ROUTINE INSPECTION	EE0000006	5026 S CRENSHAW BLVD	LOS ANGELES	FA0023656	CA	90043	OW0004133	BAZAN, ASCENCION	RESTAURANT (61-150) SEATS HIGH RISK	1638	MARGARITAS CAFE	ACTIVE	PR0011718
DA2GQRJOS	2017-03-07	LAS MOLENDERAS	97	A	1	ROUTINE INSPECTION	EE0000997	2635 WHITTIER BLVD	LOS ANGELES	FA0160416	CA	90023	OW0125379	MARISOL FEREGRINO	RESTAURANT (0-30) SEATS HIGH RISK	1632	LAS MOLENDERAS	INACTIVE	PR0148504
DAMQTA46T	2016-03-22	SANDRA'S TAMALES	93	A	1	ROUTINE INSPECTION	EE0001049	5390 WHITTIER BLVD	LOS ANGELES	FA0171769	CA	90022-4032	OW0178828	SANDRA'S TAMALES INC.	RESTAURANT (0-30) SEATS MODERATE RISK	1631	SANDRA'S TAMALES	ACTIVE	PR0164225
DAXMBTIRZ	2018-02-12	CAFE GRATITUDE	97	A	1	ROUTINE INSPECTION	EE0000828	639 N LARCHMONT BLVD STE #102	LOS ANGELES	FA0058921	CA	90004	OW0005704	CAFE GRATITUDE LARCHMONT LLC	RESTAURANT (61-150) SEATS HIGH RISK	1638	CAFE GRATITUDE	ACTIVE	PR0019854
DAK8TBMS0	2015-09-10	THE WAFFLE	90	A	1	ROUTINE INSPECTION	EE0000709	6255 W SUNSET BLVD STE #105	LOS ANGELES	FA0051830	CA	90028	OW0035796	THE WAFFLE, LLC	RESTAURANT (61-150) SEATS HIGH RISK	1638	THE WAFFLE	ACTIVE	PR0010922
DAQZAULOI	2017-10-11	INTI PERUVIAN RESTAURANT	94	A	1	ROUTINE INSPECTION	EE0000828	5870 MELROSE AVE # #105	LOS ANGELES	FA0030334	CA	90038	OW0023369	MARIN & MARTINEZ GROUP CORP.	RESTAURANT (31-60) SEATS HIGH RISK	1635	INTI PERUVIAN RESTAURANT	INACTIVE	PR0043182
DAD0XX0IG	2017-07-14	WOLFGANG PUCK EXPRESS	95	A	1	ROUTINE INSPECTION	EE0000117	308 WESTWOOD PLZ # 1390L	LOS ANGELES	FA0138414	CA	90024	OW0101772	UCLAWP LLC	RESTAURANT (151 + ) SEATS HIGH RISK	1641	WOLFGANG PUCK EXPRESS	ACTIVE	PR0122727
DAAHVVCMT	2016-11-02	IN N OUT DAILY MARKET	94	A	1	ROUTINE INSPECTION	EE0000740	5048 HUNTINGTON DR S	LOS ANGELES	FA0175610	CA	90032	OW0182143	EMME LAN P. DIEU	RESTAURANT (0-30) SEATS MODERATE RISK	1631	IN N OUT DAILY MARKET	ACTIVE	PR0168775
DAH840R2I	2016-06-30	CHOI'S MARKET	99	A	1	ROUTINE INSPECTION	EE0000740	1828 N BROADWAY	LOS ANGELES	FA0160457	CA	90031	OW0125421	YOUNG YOON	FOOD MKT RETAIL (25-1,999 SF) LOW RISK	1610	CHOI'S MARKET	ACTIVE	PR0148548
DAXJPOD1H	2017-01-04	LENTO MARKET LLC	98	A	1	ROUTINE INSPECTION	EE0000360	1288 W SUNSET BLVD	LOS ANGELES	FA0239946	CA	90026	OW0236134	LENTO MARKET LLC	FOOD MKT RETAIL (25-1,999 SF) LOW RISK	1610	LENTO MARKET LLC	ACTIVE	PR0187951
DAMHFWY2G	2016-04-05	SOPITA RAMEN	90	A	1	ROUTINE INSPECTION	EE0000884	3087 W PICO BLVD STE 9	LOS ANGELES	FA0167850	CA	90006	OW0130819	KIBOMI INC	RESTAURANT (0-30) SEATS HIGH RISK	1632	SOPITA RAMEN	ACTIVE	PR0158271
DA0919122	2017-08-10	PRINCIPIO MERCADO Y CARNICERIA	91	A	1	ROUTINE INSPECTION	EE0000721	2630 MAPLE AVE	LOS ANGELES	FA0172138	CA	90011	OW0179186	CARLOS MIGUEL GONZALEZ	FOOD MKT RETAIL (25-1,999 SF) HIGH RISK	1612	PRINCIPIO MERCADO Y CARNICERIA	ACTIVE	PR0164655
DAX2ZPD4B	2018-03-08	EL POLLO LOCO #3301	94	A	1	ROUTINE INSPECTION	EE0001048	1833 S LA CIENEGA BLVD	LOS ANGELES	FA0021252	CA	90035	OW0028128	PEG/LION, LLC	RESTAURANT (31-60) SEATS HIGH RISK	1635	EL POLLO LOCO #3301	ACTIVE	PR0029282
DAUOR00BP	2015-12-16	MARISCOS SAN MIGUEL ARCANGEL	91	A	1	ROUTINE INSPECTION	EE0000721	2614 S MAPLE AVE	LOS ANGELES	FA0136736	CA	90011-1432	OW0099393	PONCE, JUAN CARLOS	RESTAURANT (0-30) SEATS HIGH RISK	1632	MARISCOS SAN MIGUEL ARCANGEL	ACTIVE	PR0119954

serial_number:
varchar
activity_date:
datetime
facility_name:
varchar
score:
int
grade:
varchar
service_code:
int
service_description:
varchar
employee_id:
varchar
facility_address:
varchar
facility_city:
varchar
facility_id:
varchar
facility_state:
varchar
facility_zip:
varchar
owner_id:
varchar
owner_name:
varchar
pe_description:
varchar
program_element_pe:
int
program_name:
varchar
program_status:
varchar
record_id:
varchar*/

MYSQL:
select * 
from los_angeles_restaurant_health_inspections
where program_status = 'INACTIVE';

Pandas:
import pandas as pd
los_angeles_restaurant_health_inspections.head()
res = los_angeles_restaurant_health_inspections[los_angeles_restaurant_health_inspections['program_status']=='INACTIVE']

PySpark:
import pyspark.sql.functions as F
res = los_angeles_restaurant_health_inspections.filter(F.col('program_status')=='INACTIVE').toPandas()

R:
library(dplyr)
res <- subset(los_angeles_restaurant_health_inspections,program_status == 'INACTIVE')
